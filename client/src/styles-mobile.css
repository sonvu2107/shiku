/* Mobile Optimization Styles */
/* Thêm vào file styles.css hiện tại */

/* ==================== MOBILE BREAKPOINTS ==================== */
@media (max-width: 640px) {

  /* Fix horizontal scroll on mobile */
  html,
  body {
    overflow-x: hidden !important;
    max-width: 100vw !important;
    width: 100% !important;
  }


  /* Mobile-specific container adjustments */
  .container {
    @apply px-3;
  }

  /* Navbar mobile optimization */
  .navbar-mobile {
    @apply px-3 py-2;
  }

  .navbar-mobile .search-container {
    @apply hidden;
  }

  .navbar-mobile .mobile-search {
    @apply block;
  }

  /* Chat layout mobile - Full screen switching */
  .chat-mobile {
    @apply flex-col;
  }

  .chat-sidebar-mobile {
    @apply w-full h-full border-b-0 border-r-0;
  }

  .chat-window-mobile {
    @apply flex-1 h-full;
  }

  /* Post cards mobile */
  .post-card-mobile {
    @apply mx-2;
  }

  .post-card-mobile .aspect-ratio {
    @apply aspect-[4/3];
  }

  /* Post metadata mobile spacing */
  .post-meta-mobile {
    @apply gap-3 sm:gap-4;
    min-width: 0;
    overflow-x: auto;
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  .post-meta-mobile::-webkit-scrollbar {
    display: none;
  }

  .post-meta-mobile>* {
    @apply flex-shrink-0;
    white-space: nowrap;
  }

  /* Đảm bảo VerifiedBadge có đủ không gian */
  .post-meta-mobile .inline-flex {
    @apply flex-shrink-0;
    min-width: max-content;
  }

  .post-meta-mobile .inline-flex img {
    @apply flex-shrink-0;
  }

  /* Form inputs mobile */
  .input-mobile {
    @apply text-base py-3 px-4;
  }

  /* Buttons mobile */
  .btn-mobile {
    @apply min-h-[44px] px-4 py-3 text-base;
  }

  /* Modal mobile */
  .modal-mobile {
    @apply mx-4 max-w-none;
  }

  /* Dropdown mobile */
  .dropdown-mobile {
    @apply w-full max-w-[calc(100vw-2rem)];
  }

  /* Emote picker mobile */
  .emote-picker {
    left: 50%;
    right: auto;
    transform: translateX(-50%);
    justify-content: center;
    flex-wrap: nowrap;
    flex-direction: row !important;
    width: max-content;
    max-width: none !important;
    padding: 8px;
    gap: 4px;
  }

  /* Bottom Nav Bar padding - prevent content from being covered */
  .pb-mobile-nav {
    padding-bottom: 60px !important;
  }

  /* Apply to main content containers */
  main,
  .main-content,
  .feed-container {
    padding-bottom: 60px;
  }
}

/* ==================== TOUCH OPTIMIZATIONS ==================== */
@media (hover: none) and (pointer: coarse) {

  /* Touch device optimizations */
  .touch-target {
    @apply min-h-[44px] min-w-[44px];
  }

  /* ===== DISABLE HOVER TRANSFORM EFFECTS ===== */
  /* These cause jank when scrolling on mobile */

  .hover\:scale-105:hover,
  .hover\:scale-110:hover,
  .hover\:scale-\[1\.02\]:hover,
  .hover\:scale-\[1\.01\]:hover {
    transform: none !important;
  }

  .hover\:-translate-y-1:hover,
  .hover\:-translate-y-0\.5:hover {
    transform: none !important;
  }

  /* Group hover transforms */
  .group:hover .group-hover\:scale-105,
  .group:hover .group-hover\:scale-110,
  .group:hover .group-hover\:scale-100 {
    transform: none !important;
  }

  .hover\:bg-gray-50:hover {
    @apply bg-transparent;
  }

  /* Disable transform effects on emote buttons */
  .emote-btn:hover,
  .comment-emote-btn:hover {
    transform: none;
  }

  /* ===== REDUCE BACKDROP BLUR INTENSITY ===== */
  /* Heavy backdrop-blur is GPU intensive on mobile */

  .backdrop-blur-xl {
    backdrop-filter: blur(8px) !important;
    -webkit-backdrop-filter: blur(8px) !important;
  }

  .backdrop-blur-2xl {
    backdrop-filter: blur(12px) !important;
    -webkit-backdrop-filter: blur(12px) !important;
  }

  .backdrop-blur-3xl {
    backdrop-filter: blur(16px) !important;
    -webkit-backdrop-filter: blur(16px) !important;
  }

  /* ===== SHORTEN LONG TRANSITIONS ===== */
  /* Long duration transitions feel sluggish on mobile */

  .duration-700 {
    transition-duration: 300ms !important;
  }

  .duration-500 {
    transition-duration: 200ms !important;
  }

  /* ===== DISABLE DECORATIVE ANIMATIONS ===== */
  /* Keep animate-pulse for loading skeletons but disable decorative ones */

  .animate-pulse:not([class*="skeleton"]):not([class*="loading"]) {
    animation: none !important;
  }

  /* Show touch feedback */
  .touch-feedback:active {
    @apply scale-95 bg-gray-100;
  }
}


/* ==================== LANDSCAPE MOBILE ==================== */
@media (max-width: 896px) and (orientation: landscape) {
  .chat-mobile-landscape {
    @apply flex-row;
  }

  .chat-sidebar-mobile-landscape {
    @apply w-64 h-full border-r border-b-0;
  }
}

/* ==================== ACCESSIBILITY ==================== */
@media (prefers-reduced-motion: reduce) {

  .transition-all,
  .transition-colors,
  .transition-transform {
    @apply transition-none;
  }

  .animate-spin {
    @apply animate-none;
  }
}

/* ==================== SCROLLBAR HIDE ==================== */
.scrollbar-hide {
  -ms-overflow-style: none;
  /* Internet Explorer 10+ */
  scrollbar-width: none;
  /* Firefox */
}

.scrollbar-hide::-webkit-scrollbar {
  display: none;
  /* Safari and Chrome */
}

/* ==================== USER NAME TRUNCATION ==================== */
.user-name-truncate {
  @apply truncate;
  max-width: 150px;
}

.user-name-truncate-mobile {
  @apply truncate;
  max-width: 100px;
}

/* ==================== TEXT TRUNCATION ==================== */
.line-clamp-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* ==================== MOBILE SEARCH ==================== */
.mobile-search-dropdown {
  @apply shadow-xl;
  max-height: 320px;
}

@media (max-width: 640px) {
  .mobile-search-dropdown {
    @apply text-xs;
  }

  .mobile-search-dropdown .touch-target {
    @apply min-h-[44px];
  }
}

/* ==================== COMMENT SECTION ==================== */
.comment-section-mobile {
  @apply overflow-hidden;
  word-wrap: break-word;
  word-break: break-word;
  hyphens: auto;
}

.comment-content {
  @apply break-words;
  overflow-wrap: break-word;
  word-wrap: break-word;
  word-break: break-word;
  hyphens: auto;
}

/* Emote display overflow fix */
.emote-display {
  @apply flex flex-wrap gap-1 max-w-full overflow-hidden;
  word-wrap: break-word;
  word-break: break-word;
}

.emote-item {
  @apply flex-shrink-0;
  max-width: 80px;
}

/* ==================== EMOTE PICKER ==================== */

@media (max-width: 640px) {
  .comment-section-mobile {
    @apply px-2;
  }

  .comment-actions-mobile {
    @apply flex-wrap gap-1;
  }

  .comment-reply-mobile {
    @apply ml-2;
  }

  /* Mobile emote display fixes */
  .emote-display {
    @apply max-w-[calc(100vw-4rem)] gap-0.5;
  }

  .emote-item {
    @apply text-xs px-1.5 py-0.5;
    max-width: 60px;
  }

  /* Nested comment emote fixes */
  .comment-nested .emote-display {
    @apply max-w-[calc(100vw-6rem)];
  }

  .comment-nested .emote-item {
    @apply text-xs px-1 py-0.5;
    max-width: 50px;
  }

}

/* ==================== ADMIN DASHBOARD MOBILE ==================== */
@media (max-width: 640px) {
  .admin-table-mobile {
    @apply text-xs;
  }

  .admin-card-mobile {
    @apply p-3;
  }

  .admin-button-mobile {
    @apply min-h-[36px] px-3 py-2 text-xs;
  }

  .admin-stats-mobile {
    @apply grid-cols-1 gap-3;
  }
}

/* ==================== SAFE AREA SUPPORT ==================== */
/* Handle safe area insets for devices with notch/home bar */
.safe-bottom {
  padding-bottom: env(safe-area-inset-bottom, 0px);
}

.pb-safe {
  padding-bottom: env(safe-area-inset-bottom, 0px);
}

/* Fix extra whitespace below bottom navbar - set html/body to full height */
@supports (height: 100dvh) {

  html,
  body {
    min-height: 100dvh;
  }
}

/* ==================== DARK MODE SUPPORT ==================== */
@media (prefers-color-scheme: dark) {
  .dark-mode-mobile {
    @apply bg-gray-900 text-white;
  }

  .dark-mode-mobile .card {
    @apply bg-gray-800 border-gray-700;
  }

  .dark-mode-mobile .input-mobile {
    @apply bg-gray-700 border-gray-600 text-white;
  }
}